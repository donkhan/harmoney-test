<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Documentation for MOOS API Integration</title>
</head>
<body>
	<br><b><u> Preface </u></b><br><br>
		This document describes the REST End Points provided by Money Box Application for external applications to communicate. 
		To Execute REST call's, External application <u> must login </u> to Money Box using valid Login Credentials.
		We provide Test Programs for reference written in JAVA. External applications developed in other languages can use these programs 
		as reference.These test programs are available <a href=https://github.com/donkhan/harmoney-test>here.</a></b> There is no advertising URL in MoneyBox.
		Please Note that Money Box is running in http now.
	<br><br>
	
	<b><u> Procedure to access the Money Box Resources </u></b><br>
	
	<ul>
  		<li>Login to Money Box using Valid login credentials </li>
  		<li>Grab the Session id received from the authentication call from HTTP Headers</li>
  		<li>For Every Subsequent Request to money box for resource access, add Session Id and X-UserId in the HTTP Headers</li>
  		<li>Logout once all operations are done.
	</ul>
	
	<b><u> Request Headers </u></b><br><br>
		The following parameters should be added to all the requests from the external application to MoneyBox
		<ul>
		 <li>Content-Type = application/json;charset=UTF-8 </li>
		 <li>User-Agent =STANDALONE_CODE </li>
		 <li>Accept = application/json </li>
		</ul> 
		<br>Except Login Request, all other requests should have the following additional headers.
		<ul>
		 <li>X-userId = User ID </li>
		 <li>Cookie = JSESSIONID= + {Session ID received from login request} </li>
		</ul>
		
	<br>
	<b><u> Login </u></b><br><br>
		URL : /harmoney2/sessionService/authenticate <br>
		HTTP Method: POST <br>
		Payload: <br> <img src="img/LoginPayload.png">	 <br>
		
		<a href=https://github.com/donkhan/harmoney-test/blob/master/src/main/java/experiment/authentication/LoginTest.java> Test Program </a> <br>
		<u> How to extract Session ID from the request Headers </u>
		<ul>
			<li> Iterate over all http headers </li>
			<li> If header name is Set-Cookie, grab the value and retrieve session id. 
		</ul>
		<u>Sample HTTP Headers </u> <br>
		<br> <img src="img/HttpSampleHeaders.png">	 <br>
	
	<b><u> Logout </u></b><br><br>
		URL : /harmoney2/sessionService/logout <br>
		HTTP Method: GET <br>
		Payload: None <br>
		<a href=https://github.com/donkhan/harmoney-test/blob/master/src/main/java/experiment/authentication/LogoutTest.java> Test Program </a> <br>
	<br> 
	
	<b> <u>Getting Stocks for given Branch and Currency </u> </b> <br> <br> 
	URL : /harmoney2/moos/get-stocks/{branch-name}/{currency} <br>
	 HTTP Method: GET <br>
	 Payload: None <br>
	 Sample Output : <br> <img src="img/StocksOutput.png">	 <br>
        
	 Error Code(s) : <br> 
		ALL_FINE = 0, <br>
		BRANCH_NOT_FOUND = 1 <br>
		CURRENCY_NOT_FOUND = 2<br>
		
	Example : /harmoney2/moos/get-stocks/Trichy/USD  <br>
	<a href=https://github.com/donkhan/harmoney-test/blob/master/src/main/java/experiment/moostest/MOOSStockRetrievalTest.java> Test Program </a> 
	<br><br>

	<b> <u>Place Orders</u> </b> <br> <br> 
	 URL : /harmoney2/moos/harmoney2/place-orders/{branch-name} <br>
	 HTTP Method: POST <br>
	 Payload:  <br> <img src="img/OrderPayload.png">	 <br>
	 Example :<br> <img src="img/OrderSample.png">	 <br>
	 Sample Output : <br> <img src="img/OrderOutput.png">	 <br>
	       	    
	 Error Code(s) : <br> 
		ALL_FINE = 0, <br>
		BRANCH_NOT_FOUND = 1 <br>
		CURRENCY_NOT_FOUND = 2<br>
		TRANSACTIONS_MISSING = 3<br>
		DEALER_NOT_FOUND = 4<br>
		ACCOUNT_NOT_FOUND = 5<br>
		ORDER_CREATION_FAILED = 6<br>
		UNKNOWN_ERROR = 7<br>
		INVALID_INPUT = 8<br>
		INSUFFICIENT_STOCKS = 9<br>
	
	<a href=https://github.com/donkhan/harmoney-test/blob/master/src/main/java/experiment/MOOSTransactionTest.java> Test Program </a>
	<br> Note: MOOS should capture receipt id and indiviual transactions id's for later uses like cancel Transaction 
	<br><br>
	
	
	<b> <u>Executing Transactions </u> </b> <br> <br> 
	 URL : /harmoney2/moos/harmoney2/execute-transactions/{branch-name} <br>
	 HTTP Method: POST <br>
	 Payload:  <br> <img src="img/OrderPayload.png">	 <br>
	 Example : <br> <img src="img/OrderSample.png">	 <br>
	 Sample Output : <br> <img src="img/TransactionOutput.png">	 <br>
	    	    
	 Error Code(s) : <br> 
		ALL_FINE = 0, <br>
		BRANCH_NOT_FOUND = 1 <br>
		CURRENCY_NOT_FOUND = 2<br>
		TRANSACTIONS_MISSING = 3<br>
		DEALER_NOT_FOUND = 4<br>
		ACCOUNT_NOT_FOUND = 5<br>
		ORDER_CREATION_FAILED = 6<br>
		UNKNOWN_ERROR = 7<br>
		INVALID_INPUT = 8<br>
		INSUFFICIENT_STOCKS = 9<br>
	
	<a href=https://github.com/donkhan/harmoney-test/blob/master/src/main/java/experiment/MOOSTransactionTest.java> Test Program </a>
	<br> Note: MOOS should capture receipt id and indiviual transactions id's for later uses like cancel Transaction 
	<br><br>
	
	<b> <u>Cancel Transactions </u> </b> <br> <br> 
	URL : /harmoney2/moos/harmoney2/cancel-transaction/{branch-name}/{branchId}/{receiptId}/{transactionId} <br>
	 HTTP Method: POST <br>
	 Payload:  <br> <img src="img/CancelTransactionPayload.png">	 <br>
	 Example: <br>  <img src="img/CancelTransactionSample.png"> <br>
	 Sample Output : <br><img src="img/CancelTransactionOutput.png"> <br>
	  
	 Error Code(s) : <br> 
		ALL_FINE = 0, <br>
		BRANCH_NOT_FOUND = 1 <br>
		CURRENCY_NOT_FOUND = 2<br>
		TRANSACTIONS_MISSING = 3<br>
		DEALER_NOT_FOUND = 4<br>
		ACCOUNT_NOT_FOUND = 5<br>
		ORDER_CREATION_FAILED = 6<br>
		UNKNOWN_ERROR = 7<br>
		INSUFFICIENT_STOCKS = 9<br>
		ALREADY_DELETED = 10 <br>
	
	<a href=https://github.com/donkhan/harmoney-test/blob/master/src/main/java/experiment/MOOSTransactionTest.java> Test Program </a> 
	<br><br>
	
		
	<b> <u>Things to care </u> </b> <br> 
		<ul> 
			<li> Please Make sure to logout. </li>
			<li> In case session times out, user will be locked and it needs administrator intervention to unlock the user id.
			<li> Multiple failed logins will result in account being locked.
		</ul>
</body>
</html>